<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="BhekOS 6.0 - Modern web-based operating system">
    <meta name="theme-color" content="#0078d4">
    <title>BhekOS 6.0</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="icons/icon-192.png">
    
    <!-- CSS Files - CORRECTED PATHS (with folders) -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/games.css">
    <link rel="stylesheet" href="css/themes.css">
    
    <style>
        /* Additional styles to ensure wallpaper shows */
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; }
        #desktop { 
            width: 100vw; 
            height: 100vh; 
            position: relative; 
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.7)), 
                        url('https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?auto=format&fit=crop&w=2564&q=80') center/cover fixed; 
            background-size: cover !important;
        }
    </style>
</head>
<body>
    <!-- Desktop Container -->
    <div id="desktop" oncontextmenu="os.showContextMenu(event)">
        <!-- Desktop Icons Container -->
        <div class="desktop-icons" id="desktopIcons"></div>
        
        <!-- Taskbar -->
        <div class="taskbar">
            <div class="taskbar-icon" onclick="os.toggleStart()">
                üü¢
            </div>
            <div class="taskbar-center" id="runningApps"></div>
            <div class="taskbar-right">
                <div class="system-tray">
                    <div class="icon" title="Wi-Fi">üì∂</div>
                    <div class="icon" title="Volume">üîä</div>
                    <div class="icon" title="Battery">üîã</div>
                    <div id="clock" class="clock">00:00</div>
                </div>
            </div>
        </div>
        
        <!-- Start Menu -->
        <div id="startMenu" style="display: none;"></div>
        
        <!-- Context Menu -->
        <div id="contextMenu" class="context-menu" style="display: none;"></div>
        
        <!-- Shutdown Screen -->
        <div id="shutdown-screen" style="display: none;"></div>
        
        <!-- Lock Screen -->
        <div id="lock-screen" style="display: none;"></div>
    </div>

    <!-- JavaScript Files - CORRECTED PATHS (with folders) -->
    
    <!-- First, load utilities from js/ folder -->
    <script src="js/utils/storage.js"></script>
    <script src="js/utils/notifications.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/utils/animations.js"></script>
    <script src="js/utils/drag-drop.js"></script>
    
    <!-- Then core files from js/core/ folder -->
    <script src="js/core/security.js"></script>
    <script src="js/core/window-manager.js"></script>
    <script src="js/core/app-manager.js"></script>
    
    <!-- Games from js/games/ folder -->
    <script src="js/games/snake.js"></script>
    <script src="js/games/flappy-bird.js"></script>
    <script src="js/games/memory.js"></script>
    <script src="js/games/game-2048.js"></script>
    <script src="js/games/puzzle.js"></script>
    <script src="js/games/tic-tac-toe.js"></script>
    
    <!-- Apps from js/apps/ folder -->
    <script src="js/apps/file-explorer.js"></script>
    <script src="js/apps/terminal.js"></script>
    <script src="js/apps/browser.js"></script>
    <script src="js/apps/media-player.js"></script>
    <script src="js/apps/settings.js"></script>
    <script src="js/apps/games.js"></script>
    <script src="js/apps/ai-chat.js"></script>
    <script src="js/apps/notepad.js"></script>
    <script src="js/apps/calculator.js"></script>
    <script src="js/apps/paint.js"></script>
    <script src="js/apps/app-store.js"></script>
    <script src="js/apps/integration-settings.js"></script>
    
    <!-- Integrations from js/integrations/ folder -->
    <script src="js/integrations/bhekthink-bridge.js"></script>
    <script src="js/integrations/bhekwork-bridge.js"></script>
    
    <!-- Main OS Core (load last) from js/core/ folder -->
    <script src="js/core/os.js"></script>
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    
    <!-- Initialization -->
    <script>
        // Initialize when page loads
        window.onload = function() {
            console.log('üöÄ Page loaded, initializing BhekOS...');
            console.log('Loading files from:', window.location.href);
            
            // Check if all files loaded
            console.log('Checking core files:');
            console.log('- os.js:', typeof BhekOS !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('- WindowManager:', typeof WindowManager !== 'undefined' ? '‚úÖ' : '‚ùå');
            console.log('- Security:', typeof BhekSecurity !== 'undefined' ? '‚úÖ' : '‚ùå');
            
            try {
                window.os = new BhekOS();
                console.log('‚úÖ BhekOS initialized successfully!');
                
                // Show welcome notification
                setTimeout(() => {
                    if (os.notify) {
                        os.notify('BhekOS 6.0', 'System initialized and ready');
                    }
                }, 1000);
            } catch (error) {
                console.error('‚ùå Failed to initialize BhekOS:', error);
                
                // Show error on screen
                const desktop = document.getElementById('desktop');
                if (desktop) {
                    desktop.innerHTML += `
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                             background: rgba(0,0,0,0.9); color: red; padding: 20px; border-radius: 10px; 
                             border: 2px solid red; z-index: 99999;">
                            <h3>‚ùå Initialization Error</h3>
                            <p>${error.message}</p>
                            <p>Check console (F12) for details</p>
                        </div>
                    `;
                }
            }
        };

        // Error handler
        window.onerror = function(msg, url, line, col, error) {
            console.error('üî• Global error:', {msg, url, line, col, error});
            return false;
        };

        // Close menus on ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.getElementById('contextMenu').style.display = 'none';
                document.getElementById('startMenu').style.display = 'none';
            }
        });

        // Update clock
        setInterval(function() {
            const clock = document.getElementById('clock');
            if (clock) {
                clock.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            }
        }, 1000);
    </script>
</body>
</html>
